<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TypedCode - ハッシュ検証</title>
  <link rel="stylesheet" href="./src/verify-hash.css">
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
</head>
<body>
  <div class="container">
    <header>
      <h1>🔐 タイピング証明ハッシュ検証</h1>
      <p class="subtitle">証明ファイル（JSON）から純粋なタイピングかを検証</p>
      <div class="nav-links">
        <a href="./index.html" class="nav-link">← エディタに戻る</a>
        <a href="./verify.html" class="nav-link">完全検証ページ →</a>
      </div>
    </header>

    <main>
      <!-- 入力セクション -->
      <section class="input-section">
        <div class="input-card">
          <h2>💾 証明ファイルから読み込み（推奨）</h2>
          <p class="help-text">typedcode-proof-*.json をドロップまたは選択</p>
          <div class="file-drop-zone" id="file-drop-zone">
            <div class="drop-zone-icon">📁</div>
            <p>ファイルをドラッグ&ドロップ</p>
            <label for="file-input" class="file-input-label">
              <input type="file" id="file-input" accept=".json" style="display: none;">
              ファイルを選択
            </label>
          </div>
        </div>

        <div class="input-card">
          <h2>📝 手動入力（参考用）</h2>
          <p class="help-text" style="color: #dc3545; font-weight: bold;">⚠️ コードとハッシュのみでは完全な検証はできません</p>
          <p class="help-text">タイピング証明ハッシュにはデバイスIDとイベント履歴が含まれるため、証明ファイル全体が必要です</p>
          <label style="display: block; margin-bottom: 5px; font-weight: bold;">コード:</label>
          <textarea id="code-input" placeholder="ここにコードを貼り付け..." style="margin-bottom: 15px;"></textarea>
          <label style="display: block; margin-bottom: 5px; font-weight: bold;">ハッシュ:</label>
          <input type="text" id="hash-input" placeholder="例: a3f8b2c9d4e5f6g7h8i9j0k1l2m3n4o5...">
        </div>

        <button class="verify-btn" id="verify-btn">🔍 検証する（手動入力の場合は警告表示）</button>
      </section>

      <!-- 結果セクション -->
      <section class="result-section" id="result-section" style="display: none;">
        <h2>検証結果</h2>

        <!-- ステータスカード -->
        <div class="status-card" id="status-card">
          <div class="status-icon" id="status-icon"></div>
          <div class="status-text">
            <h3 id="status-title">検証中...</h3>
            <p id="status-message"></p>
          </div>
        </div>

        <!-- 詳細情報 -->
        <div class="details-grid" id="details-grid" style="display: none;">
          <!-- ハッシュ一致 -->
          <div class="detail-card">
            <h3>🔐 ハッシュ検証</h3>
            <div class="badge" id="hash-valid-badge">-</div>
            <p class="detail-text" id="hash-message">-</p>
          </div>

          <!-- 純粋なタイピング -->
          <div class="detail-card">
            <h3>✍️ タイピング判定</h3>
            <div class="badge" id="pure-typing-badge">-</div>
            <p class="detail-text" id="typing-info">-</p>
          </div>

          <!-- デバイス情報 -->
          <div class="detail-card">
            <h3>💻 デバイスID</h3>
            <div class="device-id" id="device-id">-</div>
          </div>

          <!-- 統計情報 -->
          <div class="detail-card">
            <h3>📊 統計情報</h3>
            <ul class="stats-list">
              <li>総イベント数: <span id="total-events">-</span></li>
              <li>挿入イベント: <span id="insert-events">-</span></li>
              <li>削除イベント: <span id="delete-events">-</span></li>
              <li>ペーストイベント: <span id="paste-events">-</span></li>
              <li>ドロップイベント: <span id="drop-events">-</span></li>
              <li>タイピング時間: <span id="typing-time">-</span></li>
            </ul>
          </div>
        </div>

        <button class="reset-btn" id="reset-btn">別のコードを検証</button>
      </section>
    </main>

    <footer>
      <p>TypedCode - タイピング証明エディタ</p>
      <p class="footer-note">※ この検証はブラウザ内で完結し、データは外部に送信されません</p>
    </footer>
  </div>

  <script type="module" src="/src/verify-hash.js"></script>
</body>
</html>
